(function(e){function t(){var e={},t,r=function(e,t){return 0},i=[],s={},o=[],u=1,a=1,f=function(e){return e.x},l=function(e){return e.y};return e.key=function(n){return arguments.length?(t=n,e):t},e.x=function(t){return arguments.length?(f=t,e):f},e.y=function(t){return arguments.length?(l=t,e):l},e.distance=function(t){return arguments.length?(r=t,e):r},e.data=function(t){return arguments.length?(i=t,e):i},e.size=function(t){return arguments.length?(a=t,e):a},e.iterations=function(t){return arguments.length?(u=t,e):u},e.run=function(){var e=[],r={},s=Math.min(a,i.length);for(var o=0,c=2*s;o<c;o++){var h=i[~~(Math.random()*i.length)],p=t(h);if(!(p in r)){r[p]=1;var d={};d=f(h,d),d=l(h,d);if(e.push(d)>=s)break}}s=e.length;var v;for(var m=0;m<u;m++){var g=n().axes([f,l]).points(e);for(var o=0;o<s;o++)v=e[o],v.sumX=0,v.sumY=0,v.size=0,v.data=[];for(var o=0;o<i.length;o++){var b=i[o];v=g.find(b),v.sumX+=f(b),v.sumY+=l(b),v.size++,v.data.push(b)}for(var o=0;o<s;o++){v=e[o];if(!v.size)continue;v.x=v.sumX/v.size,v.y=v.sumY/v.size}}return e.map(function(e){return e.data})},e}function n(){function i(e,n){if(!e.length)return;var r=t[n%t.length],s=e.length>>1;return e.sort(o(r)),{axis:r,point:e[s],left:i(e.slice(0,s),n+1),right:i(e.slice(s+1),n+1)}}function s(e,n){var r=0;for(var i=0;i<t.length;i++){var s=t[i],o=s(e)-s(n);r+=o*o}return r}function o(e){return function(t,n){return t=e(t),n=e(n),t<n?-1:t>n?1:0}}function u(e,t,n){s(e.point,t)<s(n.point,t)&&(n=e),e.left&&(n=u(e.left,t,n));if(e.right){var r=e.axis(e.point)-e.axis(t);r*r<s(n.point,t)&&(n=u(e.right,t,n))}return n}var e={},t=[function(e){return e.x},function(e){return e.y}],n,r=[];return e.axes=function(n){return arguments.length?(t=n,e):t},e.points=function(t){return arguments.length?(r=t,n=null,e):r},e.find=function(t){return u(e.root(),t,n).point},e.root=function(e){return n||(n=i(r,0))},e}function r(){function a(e){var n=[];return s.forEach(function(s,o){r(s)!=r(e)&&i(e,s)<=t&&n.push(s)}),n}function f(e,t,i){u[i].push(e),o[r(e)]=i,t.forEach(function(e,t){if(!(r(e)in o)){var s=a(e);s.length>=n&&f(e,s,i)}o[r(e)]===-1&&(u[i].push(e),o[r(e)]=i)})}var e={},t,n,r,i=function(e,t){return 0},s=[],o={},u=[];return e.key=function(t){return arguments.length?(r=t,e):r},e.distance=function(t){return arguments.length?(i=t,e):i},e.epsilon=function(n){return arguments.length?(t=n,e):t},e.minSize=function(t){return arguments.length?(n=t,e):n},e.data=function(t){return arguments.length?(s=t,e):s},e.run=function(){return o={},u=[],s.forEach(function(e,t){id=r(e);if(!(id in o)){o[id]=1;var i=a(e);if(i.length<n)o[id]=-1;else{var s=u.length;u[s]=[],f(e,i,s)}}}),u},e}e.clustering={kmeans:t,dbscan:r}})(this);